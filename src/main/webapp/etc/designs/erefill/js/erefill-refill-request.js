define("erefill/mediators/refill-request",["jquery","stapes","./globals","json!config","jquery-ui-datepicker-fr","../../modules/overlay","../../modules/managers/cookie-manager"],function(e,t,n,r,s,o,u){"use strict";Date.prototype.yyyymmdd=function(){var e=this.getFullYear().toString(),t=(this.getMonth()+1).toString(),n=this.getDate().toString();return e+"-"+(t[1]?t:"0"+t[0])+"-"+(n[1]?n:"0"+n[0])};var a=!0,f=!0,c="",h=!1,p=!1,d={INVALID_DATE_FORMAT:0,DATE_OUT_OF_RANGE:1},v={date:"date",day:"day",dayFr:"dayFr",hours:"hours",hoursFr:"hoursFr",holiday:"holiday"},m={en:"Closed",fr:"FermÃ©"},g={pickupDeliveryStatus:undefined,bufferTime:undefined,thresholdTime:undefined,balanceBufferTime:undefined,nextPickUpTime:[],nextDeliveryTime:[],pickupHoursList:[],pickupDateList:[],enablePickupDates:[],deliveryHoursList:[],deliveryDateList:[],enableDeliveryDates:[]},y=t.subclass({constructor:function(){var t=this,n=e("#delivery").val();t.cookieManager=new u,t.firstAvailableDay=null,c=e("#operatingHours").val(),c!=""&&(c=e.parseJSON(c)),console.log(c),typeof c.pickupoperatingHours!="undefined"?t.operatingHours=t.parseOperatingHours(c.pickupoperatingHours):p=!0,e.isEmptyObject(c)&&(t.operatingHours=undefined,h=!0),typeof c.deliveruoperatingHours!="undefined"&&n==="true"&&(t.operatingHoursDelivery=t.parseOperatingHours(c.deliveruoperatingHours)),typeof c.deliveruoperatingHours=="undefined"&&e(".radio-item-refillreq input[name=medReleaseMode]:radio:not(:checked)").val("Delivery").attr("disabled","true"),t.$form=e(".form-refill-request"),t.initEvents(),e(function(){t.emit("domready")})},initEvents:function(){var t=this;t.on("domready",t.onDomReady),e(".form-refill-request").hasClass("form-refill-reminder")||e(".button-erefill").removeAttr("disabled");if(c.userToken){var n=c.userToken,r=c.bufferTime,i;i=n}setTimeout(function(){e(".form-refill-request").on("submit",function(e){e.preventDefault(),t.onFormSubmit(this)})},3e3),e("textarea[maxlength]").keyup(function(){var t=parseInt(e(this).attr("maxlength")),n=e(this).val(),r=n.length;if(r>t){var i=n.substr(0,t);e(this).val(i)}})},onDomReady:function(){var t=this;e(".drug-info-modal").on("click",function(r){r.preventDefault(),n.showOverlayLoader();var i=e(this).attr("data-modal"),s=e(this).attr("data-drug-id"),u=t.cookieManager.getCookieByName("JSESSIONID"),a=e(window.document).find("input[name='_tk']").val();e.ajax({type:"POST",url:i,data:"data_drug_id="+s+"&_tk="+a,cache:!1,success:function(e){var r=t.cookieManager.getCookieByName("JSESSIONID");o.open({content:e,wrapClassName:"",detachOnClose:!0}),n.removeOverlayLoader()},error:function(t,n,r){var i=decodeURIComponent(t.responseText),s=i.exception,o="<li>"+s+"</li>";e(".err-msg ul").html(o),e(".err-msg").show(),e(".err-msg ul").show()}})});if(e(".form-refill-request").hasClass("form-refill-reminder")){var r=e(".form-refill-request"),i=r.find(".refill-notify"),s=r.find(".refill-submit"),i=r.find(".refill-notify");e(i.find("input[name=phonenotify]")).on("click",function(){var t=i.find("input[name=phonenotify]").is(":checked"),n=i.find("input[name=emailnotify]").is(":checked");!t&&!n&&e(".refill-nodate")?s.attr("disabled",!0):s.attr("disabled",!1)}),e(i.find("input[name=emailnotify]")).on("click",function(){var e=i.find("input[name=phonenotify]").is(":checked"),t=i.find("input[name=emailnotify]").is(":checked");!e&&!t?s.attr("disabled",!0):s.attr("disabled",!1)})}else{var r=e(".form-refill-request");r.validate({errorClass:"error",onkeyup:!1,onclick:!1,onfocusout:!1,ignore:":disabled, .emailchk",rules:{phone1:{required:{depends:function(){return e("input[name=phonenotify]").is(":checked")}}},phone2:{required:{depends:function(){return e("input[name=phonenotify]").is(":checked")}}},phone3:{required:{depends:function(){return e("input[name=phonenotify]").is(":checked")}}}},errorPlacement:function(t,n){var i=e(".form-refill-request").find(".refill-notify"),s=i.find("input[name=phonenotify]").is(":checked"),o=i.find("ul.error");s?r.hasClass("form-refill-request")?t.appendTo(r.find(".refill-notify")):t.insertAfter(n):e(".refill-notify").removeClass("error")}})}var u=e("label.radio-item").children("div"),a=u.attr("class"),f=e(".delivery-options"),l=!0;f.hasClass("no-datepicker")&&(l=!1),t.selectedOption="Pickup",t.deliveryFlg=e("#delivery").val(),l||e(".pickup-option").find(".pickup-dates li").length<=0&&e(".form-refill-request .refill-submit").attr("disabled",!0),f.on("click","input[type=radio]",function(n){var r=e("input[type=radio]",f).index(this),i=e("> div",f).eq(r);e(".active",f).removeClass("active"),i.addClass("active"),e(".delivery-options .selector").show(),t.selectedOption=e(this).attr("value"),t.clearErrors(i),t.toggleButton(t.selectedOption)}),t.$pickupTimeSelector=e("select[name=pickup-time]"),t.timeOptions=t.$pickupTimeSelector.find("option"),t.timeOptionsLength=t.timeOptions.length,t.$deliveryTimeSelector=e("select[name=delivery-time]"),t.deliveryFlg==="true"&&(t.timeOptionsDelivery=t.$deliveryTimeSelector.find("option"),t.timeOptionsLengthDelivery=t.timeOptions.length);if(typeof t.operatingHours=="undefined"){var c=e(".delivery-date-picker"),d=e(".pickup-date-picker");if(h){l=!1;if(c.length>0){c.attr("disabled",!0),e("select[name='delivery-time']").attr("disabled",!0);var v='<img class="ui-datepicker-trigger" src="/etc/designs/erefill/images/erefill/icon-calendar-disabled.png" alt="Pickup-date" title="Pickup-date">';c.parent().append(v)}var d=e(".pickup-date-picker");if(d.length>0){d.attr("disabled",!0),e("select[name='pickup-time']").attr("disabled",!0);var v='<img class="ui-datepicker-trigger" src="/etc/designs/erefill/images/erefill/icon-calendar-disabled.png" alt="Pickup-date" title="Pickup-date">';d.parent().append(v)}}else if(p&&d.length>0){d.attr("disabled",!0),e("select[name='pickup-time']").attr("disabled",!0);var v='<img class="ui-datepicker-trigger" src="/etc/designs/erefill/images/erefill/icon-calendar-disabled.png" alt="Pickup-date" title="Pickup-date">';d.parent().append(v)}}l&&t.initDatePickers(),t.toggleButton(t.selectedOption)},initDatePickers:function(){var t=this,n=new Date,r=new Date(n.getFullYear(),n.getMonth(),n.getDate()+1),i="";typeof t.operatingHours!="undefined"&&(i=t.getPickUpDeliveryOperatingHours("pickup"));var s=e("html").attr("lang"),o="";t.deliveryFlg==="true"&&typeof t.operatingHoursDelivery!="undefined"&&(o=t.getPickUpDeliveryOperatingHours("delivery"));var u=function(n){n=n.yyyymmdd();var r=!0;return e.each(t.operatingHours,function(e,t){t.date===n&&t.isClosed&&(r=!1)}),[r]},a=function(n){n=n.yyyymmdd();var r=!0;return e.each(t.operatingHoursDelivery,function(e,t){t.date===n&&t.isClosed&&(r=!1)}),[r]};s&&e.datepicker.setDefaults(e.datepicker.regional[s]),t.$pickupDatePicker=e(".pickup-date-picker"),typeof t.operatingHours!="undefined"&&!h&&!p&&i&&i.date&&(t.$pickupDatePicker.datepicker({defaultDate:i.date,dateFormat:"yy-mm-dd",showOn:"button",changeMonth:!0,changeYear:!0,buttonImage:e(".form-refill-request").attr("data-cal-enable"),buttonText:t.$pickupDatePicker.attr("title"),buttonImageOnly:!0,minDate:g.pickupDateList[0].date,maxDate:g.pickupDateList[g.pickupDateList.length-1].date,beforeShowDay:u,beforeShow:function(){setTimeout(function(){e(".ui-datepicker").css("z-index",1111).addClass("uniform"),e(".ui-datepicker").find("select").uniform({selectAutoWidth:!0})},0)},onChangeMonthYear:function(){setTimeout(function(){e(".ui-datepicker").find("select").uniform({selectAutoWidth:!0})},100)}}).next("img.ui-datepicker-trigger").attr("tabIndex","0"),t.$pickupDatePicker.datepicker({}).on("focus",function(){e(this).datepicker("show");var t=e(this);e("#ui-datepicker-div").attr("tabIndex","0").focus(),e(".ui-datepicker-calendar .ui-state-default").on("keydown",function(n){n.which===13?(selectDate=(parseInt(e(this).parent().data("year"))+"-"+parseInt(e(this).parent().data("month"))+"-"+parseInt(e(this).text())).toString(),t.datepicker("setDate",selectDate),t.datepicker("hide"),t.parent().next().find(":focusable").focus()):n.which===9&&e(this).parent().next().hasClass("ui-state-disabled")&&(t.datepicker("hide"),t.parent().next().find(":focusable").focus())})}));var f=t.$pickupDatePicker.datepicker("option","maxDate"),c=t.$pickupDatePicker.datepicker("option","minDate"),d=t.$pickupDatePicker.data("datepicker");t.pickupDatePickerMaxDate=e.datepicker._determineDate(d,f,new Date),t.pickupDatePickerMinDate=e.datepicker._determineDate(d,c,new Date),t.$pickupDatePicker.on("change",function(){t.validateDate()}),t.$deliveryDatePicker=e(".delivery-date-picker"),t.deliveryFlg==="true"&&typeof t.operatingHoursDelivery!="undefined"&&o&&o.date&&(t.$deliveryDatePicker.datepicker({defaultDate:"+1d",dateFormat:"yy-mm-dd",showOn:"button",changeMonth:!0,changeYear:!0,buttonImage:e(".form-refill-request").attr("data-cal-enable"),buttonText:t.$deliveryDatePicker.attr("title"),buttonImageOnly:!0,minDate:g.deliveryDateList[0].date,maxDate:g.deliveryDateList[g.deliveryDateList.length-1].date,beforeShowDay:a,beforeShow:function(){setTimeout(function(){e(".ui-datepicker").css("z-index",1111).addClass("uniform"),e(".ui-datepicker").find("select").uniform({selectAutoWidth:!0})},0)},onChangeMonthYear:function(){setTimeout(function(){e(".ui-datepicker").find("select").uniform({selectAutoWidth:!0})},100)}}).next("img.ui-datepicker-trigger").attr("tabIndex","0"),t.$deliveryDatePicker.datepicker({}).on("focus",function(){e(this).datepicker("show");var t=e(this);e("#ui-datepicker-div").attr("tabIndex","0").focus(),e(".ui-datepicker-calendar .ui-state-default").on("keydown",function(n){n.which===13?(selectDate=(parseInt(e(this).parent().data("year"))+"-"+parseInt(e(this).parent().data("month"))+"-"+parseInt(e(this).text())).toString(),t.datepicker("setDate",selectDate),t.datepicker("hide"),t.parent().next().find(":focusable").focus()):n.which===9&&e(this).parent().next().hasClass("ui-state-disabled")&&(t.datepicker("hide"),t.parent().next().find(":focusable").focus())})}));if(t.deliveryFlg==="true"){var v=t.$deliveryDatePicker.datepicker("option","maxDate"),m=t.$deliveryDatePicker.datepicker("option","minDate"),y=t.$deliveryDatePicker.data("datepicker");t.deliveryDatePickerMaxDate=e.datepicker._determineDate(y,v,new Date),t.deliveryDatePickerMinDate=e.datepicker._determineDate(y,m,new Date)}t.$deliveryDatePicker.on("change",function(){t.validateDate(!0)}),i==null&&this.$pickupTimeSelector.find("option").remove().end().append(l).find("option[selected=selected]").removeAttr("selected"),o==null&&this.$deliveryTimeSelector.find("option").remove().end().append(l).find("option[selected=selected]").removeAttr("selected"),typeof t.operatingHours!="undefined"&&i&&i.date&&(t.$pickupDatePicker.datepicker("setDate",i.date),console.log("First available pick up",i),t.updateTimeSelector(i)),o&&o.date&&t.$deliveryDatePicker.datepicker("setDate",o.date),t.deliveryFlg==="true"&&o&&o.date&&t.updateDeliveryTimeSelector(o)},validateDate:function(t){var r=this,i=!1,s=t?e(".delivery-option"):e(".pickup-option"),o=t?r.$deliveryDatePicker:r.$pickupDatePicker,u,a=o.datepicker("getDate"),f=a.yyyymmdd(),l={};l.date=f,r.clearErrors(s);if(n.dateCheck(o)){var c=new Date(o.datepicker("getDate"));if(t){var h=+(new Date)||Date.now();c<=r.deliveryDatePickerMaxDate&&c>=r.deliveryDatePickerMinDate?i=!0:u=d.DATE_OUT_OF_RANGE}else c<=r.pickupDatePickerMaxDate&&c>=r.pickupDatePickerMinDate?i=!0:u=d.DATE_OUT_OF_RANGE}else u=d.INVALID_DATE_FORMAT;i?(r.isReadyToSend=!0,t?r.updateDeliveryTimeSelector():r.updateTimeSelector()):r.showErrors(s,o,u)},convert24Hours:function(e){var t=e.trim(),n=Number(t.match(/^(\d+)/)[1]),r=Number(t.match(/:(\d+)/)[1]),i=t.match(/\s(.*)$/)[1];i==="PM"&&n<12&&(n+=12),i==="AM"&&n===12&&(n-=12);var s=n.toString(),o=r.toString();return n<10&&(s="0"+s),r<10&&(o="0"+o),s+":"+o},timeTo12HrFormat:function(e){Math.floor(e)===e?e=Math.floor(e)+":00":e=Math.floor(e)+":30";var t=e.split(":"),n="AM";t[0]>=12&&(n="PM"),t[0]>12&&(t[0]=t[0]-12);var r=t[0]+":"+t[1]+" "+n;return r},calculateOperatingHours:function(e,t,n,r){var i=new Date,s=new Date,o=(new Date(i.getFullYear(),i.getMonth(),i.getDate(),e,t,0)).getTime(),u=(new Date(s.getFullYear(),s.getMonth(),s.getDate(),n,r,0)).getTime();return(u-o)/36e5},addThirtyMinutes:function(e,t,n){var r=this,i=r.timeTo12HrFormat(e);n==="pickup"?g.nextPickUpTime.push(i):g.nextDeliveryTime.push(i),e+=.5,e<=t&&r.addThirtyMinutes(e,t,n)},checkShopStatus:function(e){var t=this,n={requestHour:(new Date).getHours(),requestMinute:(new Date).getMinutes(),requestDate:new Date,balanceBuffer:g.balanceBufferTime?g.balanceBufferTime:undefined};console.log(n);var r=0;if(!e.holiday&&e.hours!=="Closed"&&(new Date).setHours(0,0,0,0,0)<=new Date(e.date)){var i,s={openHour:Number(t.convert24Hours(e.hours.split("-")[0]).match(/^(\d+)/)[1]),closeHour:Number(t.convert24Hours(e.hours.split("-")[1]).match(/^(\d+)/)[1]),openMinutes:Number(t.convert24Hours(e.hours.split("-")[0]).match(/:(\d+)/)[1]),closeMinutes:Number(t.convert24Hours(e.hours.split("-")[1]).match(/:(\d+)/)[1]),buffer:g.bufferTime,thresholdHours:Math.floor(g.thresholdTime),thresholdMinutes:g.thresholdTime-Math.floor(g.thresholdTime)===0?0:30,totalOperatingHours:undefined,todayStoreOpenHours:undefined,todayStoreOpenMinutes:undefined,pickupWithBuffer:undefined};s.totalOperatingHours=t.calculateOperatingHours(s.openHour,s.openMinutes,s.closeHour,s.closeMinutes),s.pickupWithBuffer=t.calculateOperatingHours(s.thresholdHours,s.thresholdMinutes,s.closeHour,s.closeMinutes),g.nextPickUpTime=[],g.nextDeliveryTime=[];if((new Date).getDate()===(new Date(e.date)).getDate()&&!g.balanceBufferTime){if(!(n.requestHour<s.closeHour))return g.balanceBufferTime=s.buffer,!1;n.requestHour<s.openHour?(n.requestMinute=s.openMinutes,n.requestHour=s.openHour):n.requestMinute>0&&n.requestMinute<=30?n.requestMinute=30:n.requestMinute>30&&(n.requestHour++,n.requestMinute=0),i=t.calculateOperatingHours(n.requestHour,n.requestMinute,s.closeHour,s.closeMinutes),s.todayStoreOpenHours=Math.floor(i),s.todayStoreOpenMinutes=i-Math.floor(i)>0?30:0,n.balanceBuffer=g.bufferTime-i;if(n.balanceBuffer>0)return g.balanceBufferTime=n.balanceBuffer,!1;r=n.requestHour+g.bufferTime,n.requestMinute>0&&(r+=.5);if(s.pickupWithBuffer<r)return g.balanceBufferTime=0,!1;t.addThirtyMinutes(r,s.pickupWithBuffer,g.pickupDeliveryStatus),g.balanceBufferTime=!1}else if(g.balanceBufferTime>0){g.balanceBufferTime=n.balanceBuffer-s.totalOperatingHours,r=n.balanceBuffer+s.openHour+(s.openMinutes>0?.5:0);if(g.balanceBufferTime<0&&r>s.pickupWithBuffer)return!1;if(g.balanceBufferTime>0)return!1;if(g.balanceBufferTime===0&&s.closeHour>s.pickupWithBuffer)return g.balanceBufferTime=!1,!1;t.addThirtyMinutes(r,s.pickupWithBuffer,g.pickupDeliveryStatus),g.balanceBufferTime=!1}else g.balanceBufferTime<=0&&(new Date).getDate()!==(new Date(e.date)).getDate()&&(r=s.openHour+(s.openMinutes>0?.5:0),t.addThirtyMinutes(r,s.pickupWithBuffer,g.pickupDeliveryStatus),g.balanceBufferTime=!1);return g.balanceBufferTime=!1,!0}return(new Date).getDate()===(new Date(e.date)).getDate()&&e.hours==="Closed"?(g.balanceBufferTime=g.bufferTime,!1):!1},getPickUpDeliveryOperatingHours:function(e){g.pickupDeliveryStatus=e;var t=this,n=undefined,r,i={};return g.pickupDeliveryStatus==="pickup"?(n=c.pickupoperatingHours,g.bufferTime=c.pickUpBufferTime/60,g.thresholdTime=c.pickUpThreshold/60):g.pickupDeliveryStatus==="delivery"&&(n=c.deliveruoperatingHours,g.bufferTime=c.homeDropBufferTime/60,g.thresholdTime=c.homeDropThreshold/60),g.balanceBufferTime=!1,n.forEach(function(e){r=t.checkShopStatus(e);if(!r)return!1;i={date:e.date,time:g.pickupDeliveryStatus==="pickup"?g.nextPickUpTime:g.nextDeliveryTime},g.pickupDeliveryStatus==="pickup"?(g.pickupHoursList[e.date]=i,g.pickupDateList.push(e),g.enablePickupDates.push(e.date)):(g.deliveryHoursList[e.date]=i,g.deliveryDateList.push(e),g.enableDeliveryDates.push(e.date)),console.log(g.pickupHoursList),console.log(g.pickupDateList),console.log(g.enablePickupDates),console.log(g.deliveryHoursList),console.log(g.deliveryDateList),console.log(g.enableDeliveryDates)}),g.pickupDeliveryStatus==="pickup"?g.pickupDateList[0]&&g.pickupDateList[0].date?g.pickupHoursList[g.pickupDateList[0].date]:null:g.deliveryDateList[0]&&g.deliveryDateList[0].date?g.deliveryHoursList[g.deliveryDateList[0].date]:null},updateTimeSelector:function(e){var t=this,n=e,r=0,i=null,s=null,o=!1,u=n?n.time[0]:undefined,a=n?n.time[n.time.length-1]:undefined;if(!n||n=="undefined"){var f=t.$pickupDatePicker.datepicker("getDate").yyyymmdd();g.pickupHoursList[f]&&(n=g.pickupHoursList[f],u=g.pickupHoursList[f].time[0],a=g.pickupHoursList[f].time[g.pickupHoursList[f].time.length-1])}for(r;r<t.timeOptionsLength;r+=1){!i&&Number(t.timeOptions[r].value)===Number(t.convert24Hours(u).replace(/\:/g,""))&&(i=r),!s&&Number(t.timeOptions[r].value)===Number(t.convert24Hours(a).replace(/\:/g,""))&&(s=r+1);if(i&&s)break}var l=t.timeOptions.slice(i,s);t.$pickupTimeSelector.find("option").remove().end().append(l).find("option[selected=selected]").removeAttr("selected");var c=t.$pickupTimeSelector.find("option:eq(0)");c.attr("selected","selected"),t.$pickupTimeSelector.val(c.val()),t.$pickupTimeSelector.siblings("span").html(c.text())},updateDeliveryTimeSelector:function(e){var t=this,n=e,r=0,i=null,s=null,o=!1,u=n?n.time[0]:undefined,a=n?n.time[n.time.length-1]:undefined;if(t.deliveryFlg==="true"&&typeof t.operatingHoursDelivery!="undefined"){if(!n||n=="undefined"){var f=t.$deliveryDatePicker.datepicker("getDate").yyyymmdd();g.deliveryHoursList[f]&&(n=g.deliveryHoursList[f],u=g.deliveryHoursList[f].time[0],a=g.deliveryHoursList[f].time[g.deliveryHoursList[f].time.length-1])}for(r;r<t.timeOptionsLengthDelivery;r+=1){typeof t.timeOptionsDelivery[r]!="undefined"&&typeof n!="undefined"&&(!i&&Number(t.timeOptionsDelivery[r].value)===Number(t.convert24Hours(u).replace(/\:/g,""))&&(i=r),!s&&Number(t.timeOptionsDelivery[r].value)===Number(t.convert24Hours(a).replace(/\:/g,""))&&(s=r+1));if(i&&s)break}var l=t.timeOptionsDelivery.slice(i,s);t.$deliveryTimeSelector.find("option").remove().end().append(l).find("option[selected=selected]").removeAttr("selected");var c=t.$deliveryTimeSelector.find("option:eq(0)");c.attr("selected","selected"),t.$deliveryTimeSelector.val(c.val()),t.$deliveryTimeSelector.siblings("span").html(c.text())}else t.$deliveryTimeSelector.find("option").remove().end()},parseOperatingHours:function(t){var r=[],i=n.isFrench?v.hoursFr:v.hours;return e.each(t,function(e,t){var n=t[i],s={};if(n===m.fr||n===m.en)return s.isClosed=!0,s.date=t.date,s.open=s.close=null,r.push(s),!0;var o=n.split(" - "),u=0,a=o.length,f=!1,l=!1;for(u;u<a;u++){f=o[u].toUpperCase().indexOf("PM")>-1,l=o[u].toUpperCase().indexOf("AM")>-1,o[u]=o[u].replace(/\s|AM|PM|h|:/g,"");if(f&&o[u]!=="1200"||l&&o[u]==="1200")o[u]=(Number(o[u])+1200).toString(),u==0&&f&&parseInt(o[0])>2400&&(o[0]=hoursTime),u==1&&f&&parseInt(o[1])>2400&&(o[1]=hoursTime),u==0&&l&&parseInt(o[0])==2400&&(o[0]="000"),u==0&&l&&parseInt(o[0])>1200&&(o[0]="0"+String(parseInt(o[0])-1200)),u==1&&l&&o[1]==="1200"&&(o[1]=parseInt(o[1])+1200)}s.open=o[0],s.close=o[1],s.date=t.date,r.push(s)}),r},showErrors:function(t,n,r){var i=this,s=t.find(".err-msg ul"),o;i.clearErrors(t),i.isReadyToSend=!1;switch(r){case d.DATE_OUT_OF_RANGE:o=n.data("msg-out-of-range");break;case d.INVALID_DATE_FORMAT:o=n.data("msg-malformed-date");break;case undefined:o=n.data("msg-required")}s.length?s.append(e("<li></li>").text(o)):alert(o),e(".refill-submit").attr("disabled","disabled")},onFormSubmit:function(t){var r=this,i=e(t),s=i.find(".delivery-options"),u=i.find(".refill-notify"),a=!0,f,l,c={},h={},p=[],d={},v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M,_,D,P,H,B,j,F,I,q,R,U,z;m=i.find("[name=refillType]").val()||"",g=r.selectedOption,y=i.find("[name=emailStatus]").val()||"",b=i.find("[name=patientOID]").val()||"",w=i.find("[name=patientDefaultPharmacy]").val()||"",E=i.find("[name=comments]").val()||"",x=r.selectedOption,T=i.find("[name=DelReleaseDate]").val()||"",N=i.find("[name=PickReleaseDate]").val()||"",C=i.find("[name=pickup-time]").val()||"",H=i.find("[name=delivery-time]").val()||"",k=i.find("[name=mobile]").val()||"",L=i.find("[name=deliveryaddress]").val()||"",A=i.find("[name=deliverycity]").val()||"",O=i.find("[name=deliveryPhoneNumber]").val()||"",M=i.find("[name=deliverypostalCode]").val()||"",_=i.find("[name=eProvince]").val()||"",v=i.find("[name=date-range]").val()||"",B=i.find("[name=freedeldeptid]").val()||"",j=i.find("[name=storeId]").val()||"",F=e(window.document).find("input[name='_tk']").val()||"",q=u.find("input[name=phonenotify]").is(":checked"),R=i.find("[name=phone]").val(),U=u.find("input[name=emailnotify]").is(":checked"),z=i.find("[name=email]").val(),q?I=R:I="",U?S=z:S="",e("input[name=prescOrigOID]").each(function(){p.push({comments:e(this).prev("textarea").val(),oid:e(this).val(),originalOID:""})});var W={refillType:m,deliveryChoice:g,emailStatus:y,dateRange:v,patientOID:b,pharmacyContractNumber:w,dummy:"",comments:E,email:S,phone:I,lastState:"",lastStateDate:"",medReleaseMode:x,delReleaseDate:T,pickReleaseDate:N,pickReleaseTime:C,delReleaseTime:H,phone1:"",phone2:"",phone3:"",freeDelDeptId:B,storeId:j,prescriptions:{rxRenewPrescription:p},delivery:{address:L,city:A,fax:"",phone:O,postalCode:M,province:_}};s.hasClass("no-datepicker")&&(a=!1),a?(f=r.selectedOption==="Pickup"?r.$pickupDatePicker:r.$deliveryDatePicker,l=f.datepicker("getDate")!==null):l=!0,l&&(r.isReadyToSend=!0);var X=!0;e(".form-refill-request").find("input.phone-field").hasClass("error")&&(X=!1);if(l&&r.isReadyToSend){if(u.hasClass("required")&&!i.hasClass("form-refill-reminder")){var U=u.find("input[name=email]").is(":checked"),q=u.find("input[name=mobile]").is(":checked"),V=u.data("msg-notify"),J=u.find("ul.error");!U&&!q&&J.empty().append(e("<li></li>").text(V))}var K=e(".delivery-options > div").not(".active"),Q=K.find("input, textarea, select");if(X){Q.attr("disabled","disabled");if(e(".refill-notify .checkbox-item .checker span input").is(":checked")){var G=e("body").data("page-analytics");if(typeof dataLayer!="undefined"){var Y="";try{dataLayer.push({category:G.pageCategory,action:"engagement:email opt-in",label:"refill processed notification",value:"",event:"GA Event"})}catch(Z){throw"There was an error submitting Analytics data. Check that GTM was loaded, or that your call is properly setup."}}}n.showOverlayLoader(),e(".form-refill-request").find("textarea").each(function(){e(this).val()&&(h=e(this).val())}),window.setTimeout(function(){e.ajax({type:"POST",url:i.attr("action"),headers:{_tk:F,"Data-Type":"application/json","Content-Type":"application/json; charset=utf-8"},data:JSON.stringify(W),success:function(t){var r=e(".form-footer-refill-cancel").find("button[type=submit]").attr("data-pagenumber")||e(".form-footer-refill-cancel input[name='page_num']").val();typeof t=="string"&&(t=e.parseJSON(t));var s={},u,a,f=!1;s.refillType=t.refillType,s.deliveryChoice=t.deliveryChoice,s.updatestatus=t.update_status,s.page_num=r,t.email&&(s.email=t.email),t.phone&&(s.mobile=t.phone),t.errorType&&(s.errorType=t.errorType),t.date&&(s.date=t.date),s.date=t.date;if(t.update_status=="ok")t.refillType=="auto"?u=i.attr("data-auto-success"):t.refillType=="reminder"?u=i.attr("data-reminder-success"):t.refillType=="refill"&&(u=i.attr("data-refill-success"));else if(t.update_status=="error"){f=!0;if(s.errorType){var l="p.hiddenErrorMessage."+s.errorType;e(l).removeClass("hiddenErrorMessage")}t.refillType=="auto"?u=i.attr("data-auto-error"):t.refillType=="reminder"?u=i.attr("data-reminder-error"):t.refillType=="refill"&&(u=i.attr("data-refill-error"))}require(["tpl!"+u],function(t){o.open({content:s,template:t,wrapClassName:"",refresh:!0}),o.on("create",function(){e(".overlay-wrap").css("top",0),e(".overlay-screen").css("top",0);if(f&&s.errorType){var t="p.hiddenErrorMessage."+s.errorType;e(t).removeClass("hiddenErrorMessage")}var r=e("#pageNumberHiddenValue").val();if(r==null||r=="null")r="";var i=e(o.getElement().find(".form-details")[0]),u=i.attr("action");u+=r,i.attr("action",u);var a=e(".impersonatedTitle");a.length!=0&&a.html(e("select[name='current-account'] option:selected").text()),n.removeOverlayLoader()})})},fail:function(t,r,i){t.status==403&&(n.removeOverlayLoader(),window.location.href=e(".banner a").attr("href")),alert("There was an error submitting your request. Please try again."),n.removeOverlayLoader()}})},500)}}else r.showErrors(i.find(".delivery-options .active"),f)},getFirstAvailablePickupTime:function(){var t=this,n=t.operatingHours,r,s,o;r=new Date("September 16, 2014 14:00:00"),s=String(r.getHours()),o=r.getMinutes(),console.log(r,"->",s,o);var u=s,a=o,l=c.pickUpBufferTime,h=c.pickUpThreshold,p="",d=s,v=o;o<10&&(console.log("trying to roundoff"),o="0"+o);var m=(s[1]?s:"0"+s)+o,g=r.yyyymmdd();a<10&&(console.log("trying to roundoff bufferminutes"),a="0"+a);var y=u+a;console.log(y);var b=0,w=!1,E=!0,S="",x,T=function(){if(b>n.length-1)return!1;var e=n[b],t="",r="";console.log(parseInt(y),"---",e.open),parseInt(y)<e.open&&(console.log(e.open,e.open.length),e.open.length===3?(console.log("if- exactly open time"),u=e.open.substring(0,1),a=e.open.substring(1,3),console.log(u,a)):(console.log("else- exactly open time"),u=e.open.substring(0,2),a=e.open.substring(2,4),console.log(u,a)),y=u+a),parseInt(y)==e.open&&(console.log("open time is same as request time"),u=e.open.substring(0,2),a=e.open.substring(2,4));var i=parseInt(l)+parseInt(h),f="",c="",S="",x="",T="",N="",C="",k="",L="",A="",O="",M="";i>=60?(f=parseInt(i/60),c=i%60):(f=0,c=i),console.log("bH",f,"+ bM",c),console.log("curr date: "+e.date+" | closing hours: "+e.close+" | "+e.open+" | bufferHour: "+f+" | bufferMinute: "+c),e.close!=null&&(e.close.length===3?(S=e.close.substring(0,1),x=e.close.substring(1,3)):(S=e.close.substring(0,2),x=e.close.substring(2,4)),e.open.length===3?(O=e.open.substring(0,1),M=e.open.substring(1,3)):(O=e.open.substring(0,2),M=e.open.substring(2,4))),console.log("current",O,M),h>=60?(L=parseInt(h/60),A=h%60):(L=0,A=h),console.log("carry forward buffer",p),p!==""&&(l=p),l>=60?(T=parseInt(l/60),N=l%60):(T=0,N=l),m<e.open?(T=String(Number(s)+Number(T)),N=String(Number(o)+Number(N))):(T=String(Number(s)+Number(T)),N=String(Number(o)+Number(N))),console.log("isko dekho next: "+T+" | bufferCurrentMinute: "+N),N>30?(T=String(Number(T)+1),N="00"):N="30";var _=T+N;L=String(Number(S)-Number(L)),x>A?A=String(Number(x)-Number(A)):A=String(Number(A)-Number(x)),A>30?(L=String(Number(L)-1),A="00"):(L=String(Number(L)-1),A="30");var D=L+A;S=String(Number(S)-Number(f)),x=String(Number(x)-Number(c)),x>30?(S=String(Number(S)+1),x="00"):x>0&&x<31?x="30":x<0?(S=String(Number(S)-1),x="30"):x="00";var P=S+x;if(e.date>=g){if(w&&!e.isClosed){var H="",B="",j="",F="";e.close.length===3?(H=e.close.substring(0,1),B=e.close.substring(1,3)):(H=e.close.substring(0,2),B=e.close.substring(2,4)),e.open.length===3?(j=e.open.substring(0,1),F=e.open.substring(1,3)):(j=e.open.substring(0,2),F=e.open.substring(2,4));var I=H-j,q=B-F;q===-30&&(I-=1,q=30);var R=I+q,U=I*60+q;if(U>=parseInt(l)+parseInt(h))return e;l-=U,l<0&&(l=0),w=!0}else if(!e.isClosed&&parseInt(P)>=parseInt(m))if(parseInt(m)<=parseInt(e.open)){var H="",B="",j="",F="";e.close.length===3?(H=e.close.substring(0,1),B=e.close.substring(1,3)):(H=e.close.substring(0,2),B=e.close.substring(2,4)),e.open.length===3?(j=e.open.substring(0,1),F=e.open.substring(1,3)):(j=e.open.substring(0,2),F=e.open.substring(2,4));var I=H-j,q=B-F;q===-30&&(I-=1,q=30);var R=I+q,U=I*60+q;if(U>l)return e;l-=U,w=!0}else{var z="",W="";e.close.length===3?(z=e.close.substring(0,1),W=e.close.substring(1,3)):(z=e.close.substring(0,2),W=e.close.substring(2,4));var X=z-s,V="";W>o?V=W-o:V=o-W,X>0&&o!=="00"&&(X-=1);var $=X*60+V;if($>l&&parseInt(_)<=parseInt(D))return e;l-=$,l<=0&&(l=0),w=!0}else if(!e.isClosed&&parseInt(P)<parseInt(m))if(parseInt(m)<parseInt(e.open)){var H="",B="",j="",F="";e.close.length===3?(H=e.close.substring(0,1),B=e.close.substring(1,3)):(H=e.close.substring(0,2),B=e.close.substring(2,4)),e.open.length===3?(j=e.open.substring(0,1),F=e.open.substring(1,3)):(j=e.open.substring(0,2),F=e.open.substring(2,4));var I=H-j,q=B-F;q===-30&&(I-=1,q=30);var R=I+q,U=I*60+q;if(U>l)return e;l-=U,w=!0}else if(parseInt(m)>parseInt(e.close))w=!0;else{var z="",W="";e.close.length===3?(z=e.close.substring(0,1),W=e.close.substring(1,3)):(z=e.close.substring(0,2),W=e.close.substring(2,4));var X=z-d;X>0&&(X-=1);var V="";parseInt(W)===0&&parseInt(v)!==0?V=60-v:W>v?V=W-v:V=v-W;var $=X*60+V,J="",K="";h>=60?(J=parseInt(h/60),K=h%60):(J=0,K=h);var Q=z-J,G=W-K;G===0?G="00":G===30?G="30":G===-30&&(G="30",Q-=1);var Y=Q+G;if($>parseInt(l)+parseInt(h)&&parseInt(m)<parseInt(Y)){var Z="",et="",tt="",nt="";h>=60?(Z=parseInt(h/60),et=h%60):(Z=0,et=h),l>=60?(tt=parseInt(l/60),nt=l%60):(tt=0,nt=l);var rt="",it="",st="",ot="",ut="",at="";et>30?(rt=String(Number(z)-1),it="00"):(rt=String(Number(z)-1),it="30"),tt>0&&(d=parseInt(d)+parseInt(tt)),nt>30?(ot=String(Number(d)+1),ut="00"):(ot=d,ut="30"),st=rt+it,at=ot+ut;if(!(at>=st))return e;l=0,w=!0}else l-=$,l<0&&(l=0),w=!0}else{if(!e.isClosed&&w)return e;if(e.isClosed||E&&e.close<=m)w=!0}E=!1}return b++,undefined},N=function(){if(typeof x!="undefined")if(x.close===null)b++,x=T(),N();else{if(x.close>m)do x=T();while(typeof x=="undefined");C=x.open||"000"}else b++,x=T(),N();return!1};while(typeof x=="undefined")x=T();var C,k;w?N():C=m;if(!n[b])f=!1,e(".form-refill-request .refill-submit").attr("disabled",!0);else{f=!0,C=parseInt(C)>parseInt(n[b].open)?C:n[b].open;var L="",A="",O="",M="";C.length===3?(L=C.substring(0,1),A=C.substring(1,3)):(L=C.substring(0,2),A=C.substring(2,4)),l>=60?(O=parseInt(l/60),M=l%60):(O=0,M=String(l)),L=String(Number(L)+Number(O)),A=String(Number(A)+Number(M)),parseInt(A)===0&&(A="00"),A>=60&&(L=parseInt(L)+1,A="30"),A>30?(L=parseInt(L)+1,A="00"):A>0&&A<=30?A="30":A===0&&(A="00"),C=L+A,n[b].open=C;var _="",D="",P="",H="",B="",j="";n[b].length===3?(_=n[b].close.substring(0,1),D=n[b].close.substring(1,3)):(_=n[b].close.substring(0,2),D=n[b].close.substring(2,4)),h>=60?(P=parseInt(h/60),H=h%60):(P=0,H=h),H===0&&(H="00"),B=_-P,D==="00"&&H!="00"&&(D="60"),j=D-H,j===30?(j="00",B+=1):j===-30?j="00":j===0?j="30":j<0?(B-=1,j="30"):j>0&&j<30?j="30":j>30&&(j="00"),k=String(String(B)+String(j)),n[b].close=k;var F=6-b;if(F!==0)for(i=0;i<F;i++){b+=1;var I="",q="";if(n[b].close!==null){n[b].length===3?(I=n[b].close.substring(0,1),q=n[b].close.substring(1,3)):(I=n[b].close.substring(0,2),q=n[b].close.substring(2,4)),I-=P,q-=H,q===30?(q="00",I=B+1):q===-30?q="00":q===0?q="30":q<0?(I=B-1,q="30"):q>0&&q<30?q="30":q>30&&(q="00");var R=String(I)+String(q);n[b].close=R}}}return{open:C,close:x.close,date:x.date}},getFirstAvailableDeliveryTime:function(){var t=this,n=t.operatingHoursDelivery,r=new Date,s=String(r.getHours()),o=r.getMinutes(),u=s,f=o,l=c.homeDropBufferTime,h=c.homeDropThreshold,p="",d=s,v=o;o<10&&(o="0"+o);var m=(s[1]?s:"0"+s)+o,g=r.yyyymmdd(),y=u+f,b=0,w=!1,E=!0,S="",x,T=function(){if(b>n.length-1)return!1;var e=n[b],t="",r="";parseInt(y)<e.open&&(e.open.length===3?(u=e.open.substring(0,1),f=e.open.substring(1,3)):(u=e.open.substring(0,2),f=e.open.substring(2,4)),y=u+f);var i=parseInt(l)+parseInt(h),a="",c="",S="",x="",T="",N="",C="",k="",L="",A="",O="",M="";i>=60?(a=parseInt(i/60),c=i%60):(a=0,c=i),e.close!=null&&(e.close.length===3?(S=e.close.substring(0,1),x=e.close.substring(1,3)):(S=e.close.substring(0,2),x=e.close.substring(2,4)),e.open.length===3?(O=e.open.substring(0,1),M=e.open.substring(1,3)):(O=e.open.substring(0,2),M=e.open.substring(2,4))),h>=60?(L=parseInt(h/60),A=h%60):(L=0,A=h),p!==""&&(l=p),l>=60?(T=parseInt(l/60),N=l%60):(T=0,N=l),m<e.open?(T=String(Number(s)+Number(T)),N=String(Number(o)+Number(N))):(T=String(Number(s)+Number(T)),N=String(Number(o)+Number(N))),N>30?(T=String(Number(T)+1),N="00"):N="30";var _=T+N;L=String(Number(S)-Number(L)),x>A?A=String(Number(x)-Number(A)):A=String(Number(A)-Number(x)),A>30?(L=String(Number(L)-1),A="00"):(L=String(Number(L)-1),A="30");var D=L+A;S=String(Number(S)-Number(a)),x=String(Number(x)-Number(c)),x>30?(S=String(Number(S)+1),x="00"):x>0&&x<31?x="30":x<0?(S=String(Number(S)-1),x="30"):x="00";var P=S+x;if(e.date>=g){if(w&&!e.isClosed){var H="",B="",j="",F="";e.close.length===3?(H=e.close.substring(0,1),B=e.close.substring(1,3)):(H=e.close.substring(0,2),B=e.close.substring(2,4)),e.open.length===3?(j=e.open.substring(0,1),F=e.open.substring(1,3)):(j=e.open.substring(0,2),F=e.open.substring(2,4));var I=H-j,q=B-F;q===-30&&(I-=1,q=30);var R=I+q,U=I*60+q;if(U>=parseInt(l)+parseInt(h))return e;l-=U,l<0&&(l=0),w=!0}else if(!e.isClosed&&parseInt(P)>=parseInt(m))if(parseInt(m)<=parseInt(e.open)){var H="",B="",j="",F="";e.close.length===3?(H=e.close.substring(0,1),B=e.close.substring(1,3)):(H=e.close.substring(0,2),B=e.close.substring(2,4)),e.open.length===3?(j=e.open.substring(0,1),F=e.open.substring(1,3)):(j=e.open.substring(0,2),F=e.open.substring(2,4));var I=H-j,q=B-F;q===-30&&(I-=1,q=30);var R=I+q,U=I*60+q;if(U>l)return e;l-=U,w=!0}else{var z="",W="";e.close.length===3?(z=e.close.substring(0,1),W=e.close.substring(1,3)):(z=e.close.substring(0,2),W=e.close.substring(2,4));var X=z-s,V="";W>o?V=W-o:V=o-W,X>0&&o!=="00"&&(X-=1);var $=X*60+V;if($>l&&parseInt(_)<=parseInt(D))return e;l-=$,l<=0&&(l=0),w=!0}else if(!e.isClosed&&parseInt(P)<parseInt(m))if(parseInt(m)<parseInt(e.open)){var H="",B="",j="",F="";e.close.length===3?(H=e.close.substring(0,1),B=e.close.substring(1,3)):(H=e.close.substring(0,2),B=e.close.substring(2,4)),e.open.length===3?(j=e.open.substring(0,1),F=e.open.substring(1,3)):(j=e.open.substring(0,2),F=e.open.substring(2,4));var I=H-j,q=B-F;q===-30&&(I-=1,q=30);var R=I+q,U=I*60+q;if(U>l)return e;l-=U,w=!0}else if(parseInt(m)>parseInt(e.close))w=!0;else{var z="",W="";e.close.length===3?(z=e.close.substring(0,1),W=e.close.substring(1,3)):(z=e.close.substring(0,2),W=e.close.substring(2,4));var X=z-d;X>0&&(X-=1);var V="";parseInt(W)===0&&parseInt(v)!==0?V=60-v:W>v?V=W-v:V=v-W;var $=X*60+V,J="",K="";h>=60?(J=parseInt(h/60),K=h%60):(J=0,K=h);var Q=z-J,G=W-K;G===0?G="00":G===30?G="30":G===-30&&(G="30",Q-=1);var Y=Q+G;if($>parseInt(l)+parseInt(h)&&parseInt(m)<parseInt(Y)){var Z="",et="",tt="",nt="";h>=60?(Z=parseInt(h/60),et=h%60):(Z=0,et=h),l>=60?(tt=parseInt(l/60),nt=l%60):(tt=0,nt=l);var rt="",it="",st="",ot="",ut="",at="";et>30?(rt=String(Number(z)-1),it="00"):(rt=String(Number(z)-1),it="30"),tt>0&&(d=parseInt(d)+parseInt(tt)),nt>30?(ot=String(Number(d)+1),ut="00"):(ot=d,ut="30"),st=rt+it,at=ot+ut;if(!(at>=st))return e;l=0,w=!0}else l-=$,l<0&&(l=0),w=!0}else{if(!e.isClosed&&w)return e;if(e.isClosed||E&&e.close<=m)w=!0}E=!1}return b++,undefined},N=function(){if(typeof x!="undefined")if(x.close===null)b++,x=T(),N();else{if(x.close>m)do x=T();while(typeof x=="undefined");C=x.open||"000"}else b++,x=T(),N();return!1};while(typeof x=="undefined")x=T();var C,k;w?N():C=m;if(!n[b])a=!1,e(".form-refill-request .refill-submit").attr("disabled",!0);else{a=!0,C=parseInt(C)>parseInt(n[b].open)?C:n[b].open;var L="",A="",O="",M="";C.length===3?(L=C.substring(0,1),A=C.substring(1,3)):(L=C.substring(0,2),A=C.substring(2,4)),l>=60?(O=parseInt(l/60),M=l%60):(O=0,M=String(l)),L=String(Number(L)+Number(O)),A=String(Number(A)+Number(M)),parseInt(A)===0&&(A="00"),A>=60&&(L=parseInt(L)+1,A="30"),A>30?(L=parseInt(L)+1,A="00"):A>0&&A<=30?A="30":A===0?A="00":j<0&&(B-=1,j="30"),C=L+A,n[b].open=C;var _="",D="",P="",H="",B="",j="";n[b].length===3?(_=n[b].close.substring(0,1),D=n[b].close.substring(1,3)):(_=n[b].close.substring(0,2),D=n[b].close.substring(2,4)),h>=60?(P=parseInt(h/60),H=h%60):(P=0,H=h),H===0&&(H="00"),B=_-P,D==="00"&&H!="00"&&(D="60"),j=D-H,j===30?(j="00",B+=1):j===-30?j="00":j===0?j="30":j<0?(B-=1,j="30"):j>0&&j<30?j="30":j>30&&(j="00"),k=String(String(B)+String(j)),n[b].close=k;var F=6-b;if(F!==0)for(i=0;i<F;i++){b+=1;var I="",q="";if(n[b].close!==null){n[b].length===3?(I=n[b].close.substring(0,1),q=n[b].close.substring(1,3)):(I=n[b].close.substring(0,2),q=n[b].close.substring(2,4)),I-=P,q-=H,q===30?(q="00",I+=1):q===-30?q="00":q===0?q="30":q<0?(I-=1,q="30"):q>0&&q<30?q="30":q>30&&(q="00");var R=String(I)+String(q);n[b].close=R}}}return{open:C,close:x.close,date:x.date}},clearErrors:function(t){t.find(".err-msg ul").empty(),e(".refill-submit").removeAttr("disabled")},toggleButton:function(t){var n=e(".form-refill-request").attr("pickdata-no-date"),r=e(".form-refill-request").attr("deldata-no-date");e(".form-footer-refill p.error").text("");if(t==="Pickup"||t==="pickup")f?e(".pickup-option ul").hasClass("pickup-dates")?e(".pickup-option").find(".pickup-dates li").length<=0&&(e(".form-refill-request .refill-submit").attr("disabled",!0),e(".form-footer-refill p.error").text(n)):e(".form-refill-request").hasClass("form-refill-reminder")?e(".form-refill-request .refill-submit").attr("disabled",!0):h?e(".form-refill-request .refill-submit").attr("disabled",!0):p?e(".form-refill-request .refill-submit").attr("disabled",!0):e(".form-refill-request .refill-submit").attr("disabled",!1):(e(".refill-submit").attr("disabled","disabled"),e(".form-refill-request .refill-submit").attr("disabled",!0),e(".pickup-date-picker").attr("disabled",!0));else if(t==="Delivery"||t==="delivery")a?e(".delivery-option ul").hasClass("delivery-dates")?e(".delivery-option").find(".delivery-dates li").length<=0&&(e(".form-refill-request .refill-submit").attr("disabled",!0),e(".form-footer-refill p.error").text(r)):h?e(".form-refill-request .refill-submit").attr("disabled",!0):(e(".form-refill-request .refill-submit").attr("disabled",!1),e(".delivery-date-picker").attr("disabled",!1)):(e(".form-refill-request .refill-submit").attr("disabled",!0),e(".delivery-date-picker").attr("disabled",!0));return!0}});return new y}),require(["require-config"],function(){require(["erefill/mediators/refill-request"])}),define("erefill-refill-request",function(){}),define("erefill-refill-request",function(){});