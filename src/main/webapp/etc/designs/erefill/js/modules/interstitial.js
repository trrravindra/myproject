define(["jquery","stapes","modules/overlay","tpl!templates/global.overlay-interstitial.html"],function(e,t,n,r){var i=/^(http:|https:)?(\/\/)(www\.)?([^\/]*)/,s={selector:'a[href^="http"]:not([target=_blank]), a[href^="//"]:not([target=_blank]), a[data-interstitial="true"]:not([target=_blank])'},o=t.subclass({constructor:function(t){var n=this;n.config=e.extend({},s,t);if(!n.config.selector.length)return;n.bindEvents()},bindEvents:function(){var t=this;e(window.document).on("click",t.config.selector,e.proxy(t.blockLink,this)),e(window.document).on("click",".interstitial-proceed",function(e){e.preventDefault(),window.location=t.context.attr("href")}),e(window.document).on("click",".interstitial-cancel",function(e){e.preventDefault(),n.close()})},blockLink:function(t){var s=this,o=e(t.target),u=o.attr("href"),a=u.match(i);a=a&&a[4];var f=window.location.host.replace("www.","");if(u&&f!==a)return s.context=o,n.open({content:r.render()}),!1}});return function(e){return new o(e)}});