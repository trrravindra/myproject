define(["jquery","stapes"],function(e,t){function d(){s=e(r.triggers),o=e(r.expandedElement),u=e(r.expandedContent),a=e(r.gallery),f=e(r.imageWrappers),l=e(r.preloader),c=e(r.showAllButton),h=e(r.closeSlidingDoorButton),r.preloader&&(l=o.find(r.preloader)),r.showAllButton&&r.useShowAllButton&&(c=e(r.showAllButton)),r.closeSlidingDoorButton&&(h=o.find(r.closeSlidingDoorButton)),v()}function v(){f.length<=2&&r.useShowAllButton&&c.hide(),l.length>0&&l.hide(),h.length>0&&h.on("click",n.closeSlidingDoor),e("body").on("click",r.triggers,function(e){e.preventDefault()}),e("body").on("mouseup",r.triggers,n.openSlidingDoor)}var n,r={},i={EVENT_NAMESPACE:"SlidingDoorGallery.",triggers:".offer-gallery-photo a",expandedElement:".offer-gallery-expanded",expandedContent:".offer-gallery-content",gallery:".offer-event-gallery",imageWrappers:"div.offer-gallery-photo",useShowAllButton:!1,currentOpenItemClassName:"current-photo",preloader:".preloader",closeSlidingDoorButton:".close",parentColumnElementClassName:".column-layout",targetUrlDataAttributeName:"url",targetInlineContentDataAttributeName:"inline-content",cardUIDDataAttributeName:"offer-id"},s,o,u,a,f,l,c,h,p=!1,m=t.subclass({events:{OPEN_COMPLETE:i.EVENT_NAMESPACE+"openComplete",CLOSE_COMPLETE:i.EVENT_NAMESPACE+"closeComplete"},constructor:function(t){n=this,r=e.extend({},i,t),d()},closeSlidingDoor:function(t){t&&t.preventDefault(),e("."+r.currentOpenItemClassName,a).removeClass(r.currentOpenItemClassName),l.fadeOut(300),o.slideUp(500),n.emit(n.events.CLOSE_COMPLETE)},openSlidingDoor:function(t,i){var s=i?e(i):e(this),f=s.closest(r.imageWrappers),c=e("."+r.currentOpenItemClassName,a),h=s.data(r.targetUrlDataAttributeName),d=s.closest(r.parentColumnElementClassName);t&&t.preventDefault();if(f.hasClass(r.currentOpenItemClassName)&&t){n.closeSlidingDoor();return}o.length&&(l.fadeOut(300),o.slideUp(500,function(){c.removeClass(r.currentOpenItemClassName),f.addClass(r.currentOpenItemClassName),u.empty(),o.insertAfter(d),p=!1,o.slideDown(500,function(){p||l.fadeIn(300)});if(h)e.ajax({type:"GET",url:h,success:function(e){p=!0,l.fadeOut(300),u.html(e);var t=s.parents(".card").data(r.cardUIDDataAttributeName);n.emit(n.events.OPEN_COMPLETE,t)},failure:function(e){console.log("Error retrieving gallery details")}});else if(!h){var t=s.data(r.targetInlineContentDataAttributeName),i=e("."+t+"").clone();p=!0,l.fadeOut(300),u.html(i);var a=s.parents(".card").data(r.cardUIDDataAttributeName);n.emit(n.events.OPEN_COMPLETE,a)}}))}});return function(e){return n||new m(e)}});