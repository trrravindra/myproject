define(["jquery","stapes","modules/overlay","json!config","tpl!templates/global.overlay-location-check.html","../mediators/globals"],function(e,t,n,r,i,s){var o={el:null},u=t.subclass({constructor:function(t){var n=this;n.config=e.extend({},o,t),n.provinceCookieName="storeProvienceCookie",n.provinceCookieValues={ONTARIO:"ON",QUEBEC:"QC",BRITISHCOLUMBIA:"BC"},n.currentUrl=window.location.href,n.checkForProvinceCookie()},checkForProvinceCookie:function(){var e=this,t=s.cookieManager.getCookieByName(e.provinceCookieName);(t===null||t!==e.provinceCookieValues.ONTARIO&&t!==e.provinceCookieValues.QUEBEC&&t!==e.provinceCookieValues.BRITISHCOLUMBIA)&&n.open({content:"Please select a location",template:i,closeButtons:"",wrapClassName:"overlay-location-check-wrap"},function(){e.handleLocationOverlaySelection()})},handleLocationOverlaySelection:function(){var t=this,r=n.getElement(),i=r.find(".btn");i.on("click",function(r){r.preventDefault();var i=e(this).data("province");s.cookieManager.setCookie(t.provinceCookieName,i);if(i===t.provinceCookieValues.ONTARIO)document.location.reload();else if(i===t.provinceCookieValues.QUEBEC)n.close();else{if(i!==t.provinceCookieValues.BRITISHCOLUMBIA)throw n.close(),"Error setting cookie. Closing the province overlay so user can continue browsing anonymously.";n.close()}})}});return function(e){return new u(e)}});