/**
 * simplePagination.js v1.6
 * A simple jQuery pagination plugin.
 * http://flaviusmatis.github.com/simplePagination.js/
 *
 * Copyright 2012, Flavius Matis
 * Released under the MIT license.
 * http://flaviusmatis.github.com/license.html
 */

define("pagination",["jquery"],function(e){!function(e,t){var a={init:function(t){var i=e.extend({items:1,itemsOnPage:1,pages:0,displayedPages:3,edges:1,currentPage:1,hrefTextPrefix:"#page-",hrefTextSuffix:"",prevText:"Prev",nextText:"Next",firstText:"First",lastText:"Last",ellipseText:"&hellip;",cssStyle:"light-theme",labelMap:[],selectOnClick:!0,onPageClick:function(e,t){},onInit:function(){}},t||{}),n=this;return i.pages=i.pages?i.pages:Math.ceil(i.items/i.itemsOnPage)?Math.ceil(i.items/i.itemsOnPage):1,i.currentPage=i.currentPage-1,i.halfDisplayed=i.displayedPages/2,this.each(function(){n.addClass(i.cssStyle+" simple-pagination").data("pagination",i),a._draw.call(n)}),i.onInit(),this},selectPage:function(e){return a._selectPage.call(this,e-1),this},firstPage:function(){return this.data("pagination").currentPage>0&&a._selectPage.call(this,1),this},prevPage:function(){var e=this.data("pagination");return e.currentPage>0&&a._selectPage.call(this,e.currentPage-1),this},nextPage:function(){var e=this.data("pagination");return e.currentPage<e.pages-1&&a._selectPage.call(this,e.currentPage+1),this},lastPage:function(){var e=this.data("pagination");return e.currentPage<e.pages-1&&a._selectPage.call(this,e.pages),this},getPagesCount:function(){return this.data("pagination").pages},getCurrentPage:function(){return this.data("pagination").currentPage+1},destroy:function(){return this.empty(),this},drawPage:function(e){var t=this.data("pagination");return t.currentPage=e-1,this.data("pagination",t),a._draw.call(this),this},redraw:function(){return a._draw.call(this),this},disable:function(){var e=this.data("pagination");return e.disabled=!0,this.data("pagination",e),a._draw.call(this),this},enable:function(){var e=this.data("pagination");return e.disabled=!1,this.data("pagination",e),a._draw.call(this),this},updateItems:function(e){var t=this.data("pagination");t.items=e,t.pages=a._getPages(t),this.data("pagination",t),a._draw.call(this)},updateItemsOnPage:function(e){var t=this.data("pagination");return t.itemsOnPage=e,t.pages=a._getPages(t),this.data("pagination",t),a._selectPage.call(this,0),this},_draw:function(){var t,i,n=this.data("pagination"),r=a._getInterval(n);a.destroy.call(this),i="function"==typeof this.prop?this.prop("tagName"):this.attr("tagName");var s="OL"===i?this:e("<ol></ol>").appendTo(this);if(n.currentPage+1>1&&n.firstText&&a._appendItem.call(this,n.pages-(n.pages+1),{text:n.firstText,classes:"first"}),n.prevText&&a._appendItem.call(this,n.currentPage-1,{text:n.prevText,classes:"prev"}),r.start>0&&n.edges>0){var o=Math.min(n.edges,r.start);for(t=0;t<o;t++)a._appendItem.call(this,t);n.edges<r.start&&r.start-n.edges!=1?s.append('<li class="disabled"><span class="ellipse">'+n.ellipseText+"</span></li>"):r.start-n.edges==1&&a._appendItem.call(this,n.edges)}for(t=r.start;t<r.end;t++)a._appendItem.call(this,t);if(r.end<n.pages&&n.edges>0){n.pages-n.edges>r.end&&n.pages-n.edges-r.end!=1?s.append('<li class="disabled"><span class="ellipse">'+n.ellipseText+"</span></li>"):n.pages-n.edges-r.end==1&&a._appendItem.call(this,r.end++);var d=Math.max(n.pages-n.edges,r.end);for(t=d;t<n.pages;t++)a._appendItem.call(this,t)}n.nextText&&a._appendItem.call(this,n.currentPage+1,{text:n.nextText,classes:"next"}),n.currentPage+1<n.pages&&n.lastText&&a._appendItem.call(this,n.pages,{text:n.lastText,classes:"last"})},_getPages:function(e){return Math.ceil(e.items/e.itemsOnPage)||1},_getInterval:function(e){return{start:Math.ceil(e.currentPage>e.halfDisplayed?Math.max(Math.min(e.currentPage-e.halfDisplayed,e.pages-e.displayedPages),0):0),end:Math.ceil(e.currentPage>e.halfDisplayed?Math.min(e.currentPage+e.halfDisplayed,e.pages):Math.min(e.displayedPages,e.pages))}},_appendItem:function(t,i){var n,r,s=this,o=s.data("pagination"),d=e("<li></li>"),l=s.find("ol");t=t<0?0:t<o.pages?t:o.pages-1,n={text:t+1,classes:""},o.labelMap.length&&o.labelMap[t]&&(n.text=o.labelMap[t]),n=e.extend(n,i||{}),t==o.currentPage||o.disabled?(o.disabled?d.addClass("disabled"):d.addClass("active"),r=e('<span class="current">'+n.text+"</span>")):(r=e('<a href="'+o.hrefTextPrefix+(t+1)+o.hrefTextSuffix+'" class="page-link">'+n.text+"</a>"),r.click(function(e){return a._selectPage.call(s,t,e)})),n.classes&&r.addClass(n.classes),d.append(r),l.length?l.append(d):s.append(d)},_selectPage:function(e,t){var i=this.data("pagination");return i.currentPage=e,i.selectOnClick&&a._draw.call(this),i.onPageClick(e+1,t)}};e.fn.pagination=function(t){return a[t]&&"_"!=t.charAt(0)?a[t].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof t&&t?void e.error("Method "+t+" does not exist on jQuery.pagination"):a.init.apply(this,arguments)}}(e)}),define("erefill/mediators/my-prescriptions",["jquery","stapes","./globals","../../modules/overlay","json!config","../../modules/managers/cookie-manager","pagination"],function(e,t,a,i,n,r){"use strict";return new(t.subclass({constructor:function(){var t=this;t.initEvents(),e(function(){t.emit("domready")})},initEvents:function(){var e=this;e.on("domready",e.onDomReady)},onDomReady:function(){var t,n,r=this,s=[],o=[];if(""!=(t=e("input[name='chkdPresc']").val()||"")){if(n=t.replace(/\s|\[|\]/g,""),o=n.split(","),-1==e.inArray(t,o))for(var d=0;d<o.length;d++)s.push(o[d]),e("#"+o[d])&&!e("#"+o[d]).prop("disabled")&&e("#"+o[d]).prop("checked",!0);else e("#"+o[0]).prop("checked",!0)}e(".prescription-list :checkbox").change(function(t){e(this).is(":checked")}),e("form.form-prescriptions .normal-refill-submit").on("click",function(t){t.preventDefault(),e(this).append('<input type="hidden" name="refillType" value="normalRefillRequest" />'),window.setTimeout(function(){e("form.form-prescriptions").submit()},100)}),e(".drug-info-modal").on("click",function(t){t.preventDefault(),a.showOverlayLoader();var n=e(this).attr("data-modal"),r=e(this).attr("data-drug-id"),s=e(window.document).find("input[name='_tk']").val(),o=e(this).data("print");e.ajax({type:"GET",url:n,data:"data_drug_id="+r+"&_tk="+s,cache:!1,success:function(e){var t=e.indexOf("<body"),n=e.indexOf("</body>"),r=o?'<a href="#" class="ctrl-print">'+o+"</a>":"";-1!=t?(t=e.indexOf(">",t),-1==n&&(n=e.length),e='<div class="overlay-drug-information">'+e.substring(t+1,n-1)+r+"</div>",a.removeOverlayLoader(),i.open({content:e,refresh:!0})):(a.removeOverlayLoader(),i.open({content:e,refresh:!0})),a.removeOverlayLoader(),document.body.style.overflow="hidden"},error:function(t,a,i){var n=decodeURIComponent(t.responseText),r=n.exception,s="<li>"+r+"</li>";e(".err-msg ul").html(s),e(".err-msg").show(),e(".err-msg ul").show()}})}),e(document).on("click",".close,.acceptclose",function(e){e.preventDefault(),document.body.style.overflow="scroll"}),e(window.document).on("click",".populate-pres-stop-autorefill-modal, .populate-pres-stop-refillreminder-modal, .populate-pres-instructions-modal",function(t){t.preventDefault(),a.showOverlayLoader();var n=(e(this).attr("data-oid"),e(this).attr("data-modal")),r={};r.oid=e(this).attr("data-oid")||"",r.name=e(this).attr("data-name")||"",r.sig=e(this).attr("data-sig")||"",r.strength=e(this).attr("data-strength")||"",r.quantityfilled=e(this).attr("data-quantityfilled")||"",r.sigdecoded=e(this).attr("data-sigdecoded")||"",r.page_num=e("form.form-prescriptions input[name='page_num']").val()||"",""!==n&&require(["tpl!"+n],function(t){i.open({content:r,template:t,wrapClassName:"",refresh:!0}),i.on("create",function(t){var a=i.getElement(),n=a.find(":focusable");n.first(),n.last();n.first().focus();var r=function(t){if(9===t.keyCode||27===t.keyCode){var a=e(this),i=a.find(":focusable,iframe"),n=i.first(),r=i.last();9==t.keyCode&&(r[0]===n[0]?t.preventDefault():!0===t.shiftKey&&t.target==n[0]?(t.preventDefault(),r.focus()):!1===t.shiftKey&&t.target==r[0]&&(t.preventDefault(),n.focus()))}};a.on("keydown",i,r)}),a.removeOverlayLoader()})});var l=[],c=[],p=[],u=e("input.date-from").val(),f=e("input.date-to").val(),h=!1,m=!1;e(".for-submit").addClass("hidego"),i.on("create",function(){var t=e(".impersonatedTitle");if(0!=t.length){var a=e("select[name='current-account'] option:selected").text(),n=a.split("(")[0];n=n.replace(/\s+$/g,""),t.html(n)}var s=e(i.getElement().find(".form-details")[0]),o=e(i.getElement().find(".auto-update-email")[0]),d=e(i.getElement().find(".auto-update-mobile")[0]),l=e(i.getElement().find(".myacc-email")[0]),c=e(i.getElement().find(".mycust-email")[0]),p=e(i.getElement().find(".myacc-mob")[0]),u=e(i.getElement().find(".mycust-mob")[0]),f=s.find("button[type=submit]");c.find("div").hasClass("update-noemail")&&c.find("input[type=checkbox]").attr("disabled","true"),l.find("div").hasClass("update-noemail")&&l.find("input[type=checkbox]").attr("disabled","true"),u.find("div").hasClass("update-nomobile")&&u.find("input[type=checkbox]").attr("disabled","true"),p.find("div").hasClass("update-nomobile")&&p.find("input[type=checkbox]").attr("disabled","true"),f.on("click",function(e){e.preventDefault(),r.onFormSubmit(this)}),o.on("click",function(e){e.preventDefault(),c.find("div").hasClass("update-noemail")&&(c.find(".checker").addClass("disabled"),c.find("input[type=checkbox]").attr("disabled","false")),l.find("div").hasClass("update-noemail")&&(l.find(".checker").addClass("disabled"),l.find("input[type=checkbox]").attr("disabled","true")),c.find(".checker span").hasClass("checked")?(c.find(".checker span").removeClass("checked"),c.find("input[type=checkbox]").attr("checked",!1)):l.find(".checker span").hasClass("checked")&&(l.find(".checker span").removeClass("checked"),l.find("input[type=checkbox]").attr("checked",!1)),c.css("display","block"),l.css("display","none")}),d.on("click",function(e){e.preventDefault(),u.find("div").hasClass("update-nomobile")?(u.find(".checker").addClass("disabled"),u.find("input[type=checkbox]").attr("disabled",!0)):(u.find(".checker").removeClass("disabled"),u.find("input[type=checkbox]").attr("disabled",!1)),p.find("div").hasClass("update-nomobile")?(p.find(".checker").addClass("disabled"),p.find("input[type=checkbox]").attr("disabled",!0)):(p.find(".checker").removeClass("disabled"),p.find("input[type=checkbox]").attr("disabled",!1)),u.find(".checker span").hasClass("checked")?(u.find(".checker span").removeClass("checked"),u.find("input[type=checkbox]").attr("checked",!1)):p.find(".checker span").hasClass("checked")&&(p.find(".checker span").removeClass("checked"),p.find("input[type=checkbox]").attr("checked",!1)),u.css("display","block"),p.css("display","none")})}),e(".notification-close").on("click",function(e){}),""!=u&&""!=f&&(m=!0,h=!0,m&&h&&(e("select.myPres-submit-on-change1").attr("disabled","disabled"),e("select.myPres-submit-on-change1").parents().addClass("disabled")));var g=e(".prescription-list input[type=checkbox]"),v=e(".medication-refill input[type=radio]"),b=e(".form-prescriptions button").not(".medication-refill button"),y=e(".medication-refill button"),k=(e(".pagination a"),e(".pagination").find("strong").html());e(".date-from+.ui-datepicker-trigger").attr("title","From Date"),e(".date-to+.ui-datepicker-trigger").attr("title","To Date"),e("#removedOrderInfo").val("");var x=e("#orderInfo").val()?e("#orderInfo").val():"";if(window.setTimeout(function(){r.submitButtonPropChange(x,c,b)},200),x){p=x.split(",");for(var P=0;P<p.length;P++)l.push(p[P])}g.on("click",function(t){var a=e(this).attr("id");e("#orderInfo").val();if(y.attr("disabled",!0),y.attr("aria-disabled",!0),v.prop("checked",!1),v.uniform({selectAutoWidth:!0}),e("#refill-identifier").val(""),e(this).is(":checked")){e("#removedOrderInfo").val("");for(var i=0;i<c.length;i++)c[i]===a&&c.splice(i,1);l.push(a)}else{e("#orderInfo").val("");for(var n=0;n<l.length;n++)l[n]===a&&l.splice(n,1);c.push(a)}r.updateFilterFormHiddenField(l,""),r.updateFilterFormRemovedOrderHiddenField(c,"");var s=e("#orderInfo").val()?e("#orderInfo").val():"";localStorage.getItem("erefill-orderinfo");r.submitButtonPropChange(s,c,b)}),v.on("click",function(t){var i=e(this),n=i.parents("tr"),r=n.find("button"),s=n.find("input[type=checkbox]").attr("id");"stop-reminders"==i.val()?(e(".for-submit").addClass("hidego"),e(".for-overlay").removeClass("hidego")):(e(".for-submit").removeClass("hidego"),e(".for-overlay").addClass("hidego")),b.attr("disabled",!0),b.attr("aria-disabled",!0),g.prop("checked",!1),g.uniform({selectAutoWidth:!0}),e("#removedOrderInfo").val(""),e("#orderInfo").val(""),e("input[type='hidden'][name='refillType']").remove(),e("#refill-identifier").val(s),y.attr("disabled",!0),r.attr("aria-disabled",!0),r.attr("disabled",!1),r.attr("aria-disabled",!1),r.addClass("colorWhite"),r.on("click",function(t){var n=i.val();-1!=n.indexOf("stop-reminders")&&i.is(":checked")?t.preventDefault():-1!=n.indexOf("auto")&&i.is(":checked")?(t.preventDefault(),a.showOverlayLoader(),window.setTimeout(function(){e(".form-prescriptions").submit()},500)):-1!=n.indexOf("reminder")&&i.is(":checked")&&(t.preventDefault(),a.showOverlayLoader(),window.setTimeout(function(){e(".form-prescriptions").submit()},500))})}),e("select.myPres-submit-on-change").on("change",function(t){t.preventDefault(),e("#page_num").val(k),a.showOverlayLoader();var i=e(this);window.setTimeout(function(){i.parents("form:first").submit()},500)});var w=e("#totalrecords").text();w=parseInt(w);var C=e("#page_num").val()?e("#page_num").val():"1";e(".pagination").pagination({currentPage:C,items:w,itemsOnPage:10,firstText:"<<",lastText:">>",onPageClick:function(t,a){a.preventDefault(),e("#page_num").val(t),window.setTimeout(function(){e(".form-range-filter").submit()},500)}}),e(".pagination ul li a").on("click",function(e){a.showOverlayLoader()}),e("select.myPres-submit-on-change1").on("change",function(t){t.preventDefault(),e("#page_num").val(""),a.showOverlayLoader();var i=e(this);window.setTimeout(function(){i.parents("form:first").submit()},500)}),r.initDatePickers(),e(".refill-selected-prescription").on("click",function(t){t.preventDefault(),a.showOverlayLoader(),window.setTimeout(function(){e(".form-prescriptions").submit()},500)})},initDatePickers:function(){var t=new Date,a=(new Date(t.getFullYear(),t.getMonth(),t.getDate()+1),e(".form-range-filter")),i=e("html").attr("lang");i&&e.datepicker.setDefaults(e.datepicker.regional[i]);var n=!1,r=!1,s=e(".date-from"),o=e(".date-to");s.datepicker({showOn:"button",dateFormat:"yy-mm-dd",changeMonth:!0,changeYear:!0,buttonImage:a.attr("data-cal-enable"),buttonImageOnly:!0,buttonText:s.attr("title"),maxDate:t,onClose:function(e){e?o.datepicker("option","minDate",e):o.datepicker("option",{maxDate:t,minDate:null})},onSelect:function(t){(r=!0)&&n&&(e("select.myPres-submit-on-change1").attr("disabled","disabled"),e("select.myPres-submit-on-change1").parents().addClass("disabled"))},beforeShow:function(){setTimeout(function(){e(".ui-datepicker").addClass("uniform"),e(".ui-datepicker").find("select").uniform({selectAutoWidth:!0})},0)},onChangeMonthYear:function(){setTimeout(function(){e(".ui-datepicker").find("select").uniform({selectAutoWidth:!0})},0)}}).next("img.ui-datepicker-trigger").attr("tabIndex","0"),s.datepicker({}).on("focus",function(){e(this).datepicker("show");var t=e(this);e("#ui-datepicker-div").attr("tabIndex","0").focus(),e(".ui-datepicker-calendar .ui-state-default").on("keydown",function(a){var i;13===a.which?(i=(parseInt(e(this).parent().data("year"))+"-"+parseInt(e(this).parent().data("month"))+"-"+parseInt(e(this).text())).toString(),t.datepicker("setDate",i),t.datepicker("hide"),t.parent().next().find(":focusable").focus()):9===a.which&&e(this).parent().next().hasClass("ui-state-disabled")&&(t.datepicker("hide"),t.parent().next().find(":focusable").focus())})}),o.datepicker({showOn:"button",dateFormat:"yy-mm-dd",changeMonth:!0,changeYear:!0,buttonImage:a.attr("data-cal-enable"),buttonImageOnly:!0,buttonText:o.attr("title"),maxDate:t,onClose:function(e){e?s.datepicker("option","maxDate",e):s.datepicker("option",{maxDate:t,minDate:null})},onSelect:function(t){n=!0,r&&n&&(e("select.myPres-submit-on-change1").attr("disabled","disabled"),e("select.myPres-submit-on-change1").parents().addClass("disabled"))},beforeShow:function(){setTimeout(function(){e(".ui-datepicker").addClass("uniform"),e(".ui-datepicker").find("select").uniform({selectAutoWidth:!0})},0)},onChangeMonthYear:function(){setTimeout(function(){e(".ui-datepicker").find("select").uniform({selectAutoWidth:!0})},0)}}).next("img.ui-datepicker-trigger").attr("tabIndex","0"),o.datepicker({}).on("focus",function(){e(this).datepicker("show");var t=e(this);e("#ui-datepicker-div").attr("tabIndex","0").focus(),e(".ui-datepicker-calendar .ui-state-default").on("keydown",function(a){var i;13===a.which?(i=(parseInt(e(this).parent().data("year"))+"-"+parseInt(e(this).parent().data("month"))+"-"+parseInt(e(this).text())).toString(),t.datepicker("setDate",i),t.datepicker("hide"),t.parent().siblings("button").focus()):9===a.which&&e(this).parent().next().hasClass("ui-state-disabled")&&(t.datepicker("hide"),t.parent().siblings("button").focus())})}),e(".date-picker").on("change",function(a){var i=e(this),s=e(".date-picker").not("[name="+i.attr("name")+"]");"from"==i.attr("name")?r=!1:"to"==i.attr("name")&&(n=!1),""!=e(".date-from").val()&&""!=e(".date-to").val()?(e("select.myPres-submit-on-change1").attr("disabled","disabled"),e("select.myPres-submit-on-change1").parents().addClass("disabled")):(e("select.myPres-submit-on-change1").removeAttr("disabled","disabled"),e("select.myPres-submit-on-change1").parents().removeClass("disabled")),s&&""===s.val()&&(s.datepicker("option",{maxDate:t,minDate:null}),s.datepicker("setDate",null))})},updateFilterFormHiddenField:function(t,a){var i;e("#orderInfo").val("");for(var n=0;n<t.length;n++)n!=t.length-1?a=a+t[n]+",":a+=t[n];i=e("#orderInfo").val()?","+a:a,e("#orderInfo").val(i)},updateFilterFormRemovedOrderHiddenField:function(t,a){for(var i=0;i<t.length;i++)i!=t.length-1?a=a+t[i]+",":a+=t[i],e("#removedOrderInfo").val(a)},submitButtonPropChange:function(t,a,i){var n=e("input[name='chkdPresc']").val().replace(/\s|\[|\]/g,"");""!=t&&t!=a?(i.prop("disabled",!1),i.attr("aria-disabled",!1)):""!=n&&n!=a?(i.prop("disabled",!1),i.attr("aria-disabled",!1)):(i.prop("disabled",!0),i.attr("aria-disabled",!0))},onFormSubmit:function(t){var n=e(i.getElement().find(".form-details")[0]),r={};a.showOverlayLoader(),window.setTimeout(function(){e.ajax({type:"POST",url:n.attr("action"),data:n.serialize(),cache:!1,success:function(t){var s=t.update_type,o=t.update_status,d=t.phone,l=t.email,c=t.refillType,p=(t.deliveryChoice,t.date,t.token_status);if("ok"==o)if("optIN"==s&&"auto"==c){if(void 0!=l&&void 0==d){var u=n.attr("data-opt-out");r.email=l,r.upType=s,r.updatetype=s}else if(void 0==l&&void 0!=d){var u=n.attr("data-opt-out");r.mobile=d,r.upType=s,r.updatetype=s}else if(void 0!=d&&void 0!=l){var u=n.attr("data-opt-out");r.email=l,r.mobile=d,r.upType=s,r.updatetype=s}}else if("optOUT"==s&&"auto"==c){var u=n.attr("data-opt-out");r.upType=s,r.updatetype=s}else"stop"==s&&("auto"!=c&&"reminder"!=c||(e("#page_num").val(n.attr("data-pagenum")),window.setTimeout(function(){e(".form-range-filter").submit()},500),i.close()));else if("error"==o||"error"==p){t.token_value;var u=n.attr("data-error")}u&&require(["tpl!"+u],function(t){i.open({content:r,template:t,wrapClassName:"",refresh:!0}),i.on("create",function(t){var a=i.getElement(),n=a.find(":focusable");n.first(),n.last();n.first().focus();var r=function(t){if(9===t.keyCode||27===t.keyCode){var a=e(this),i=a.find(":focusable,iframe"),n=i.first(),r=i.last();9==t.keyCode&&(r[0]===n[0]?t.preventDefault():!0===t.shiftKey&&t.target==n[0]?(t.preventDefault(),r.focus()):!1===t.shiftKey&&t.target==r[0]&&(t.preventDefault(),n.focus()))}};a.on("keydown",i,r)}),a.removeOverlayLoader()})},fail:function(e){alert("There was an error submitting your request. Please try again."),a.removeOverlayLoader()}})},500)}}))}),require(["require-config"],function(){require(["erefill/mediators/my-prescriptions"])}),define("erefill-my-prescriptions",function(){}),define("erefill-my-prescriptions",function(){});