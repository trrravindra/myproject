/*!
	 * skrollr
	 *
	 * https://github.com/Prinzhorn/skrollr
	 *
	 * free to use under terms of MIT license
	 */

define(["jquery"],function(e){(function(e,t,n){function j(n){s=t.documentElement,o=t.body,H(),tt=this,n=n||{},ut=n.constants||{};if(n.easing)for(var i in n.easing)B[i]=n.easing[i];rt={beforerender:n.beforerender,render:n.render},it=n.forceHeight!==!1,ht=n.smoothScrolling!==!1,pt={targetTop:tt.getScrollTop()},it&&(ot=n.scale||1),Q(s,[l],[c]);if(it){var u=t.getElementById("skrollr-body")||t.createElement("div"),a=u.style;a.minWidth="1px",a.position="absolute",a.top=a.zIndex="0",u.id||(a.width="1px",a.right="0",o.appendChild(u)),function(e){$=function(){e.apply(this,arguments),a.height=st+s.clientHeight+"px"}}($)}return tt.refresh(),r.addEvent(e,"resize",$),function f(){S(f),q()}(),tt}var r=e.skrollr={get:function(){return tt},init:function(e){return tt||new j(e)},VERSION:"0.5.14"},i=Object.prototype.hasOwnProperty,s,o,u="rendered",a="un"+u,f="skrollable",l="skrollr",c="no-"+l,h="linear",p=1e3,d=200,v="start",m="end",g="top",y="center",b="bottom",w="___has_rendered_class",E="___skrollable_id",S=e.requestAnimationFrame;(function(){var t=["ms","moz","webkit","o"],n=0,r=t.length;for(;n<r&&!S;n++)S=e[t[n]+"RequestAnimationFrame"];var i=0;S||(S=function(t){var n=Z(),r=Math.max(0,30-(n-i));e.setTimeout(function(){t(n+r)},r),i=n+r})})();var x=/^\s+|\s+$/g,T=/^data(?:-(_\w+))?(?:-?(-?\d+))?(?:-?(start|end|top|center|bottom))?(?:-?(top|center|bottom))?$/,N=/\s*([a-z\-\[\]]+)\s*:\s*(.+?)\s*(?:;|$)/gi,C=/^([a-z\-]+)\[(\w+)\]$/,k=/-([a-z])/g,L=function(e,t){return t.toUpperCase()},A=/[\-+]?[\d]*\.?[\d]+/g,O=/\{\?\}/g,M=/rgba?\(\s*-?\d+\s*,\s*-?\d+\s*,\s*-?\d+/g,_=/[a-z\-]+-gradient/g,D,P,H=function(){var t=/^(?:O|Moz|webkit|ms)|(?:-(?:o|moz|webkit|ms)-)/;if(!e.getComputedStyle)return;var n=e.getComputedStyle(o,null);for(var r in n){D=r.match(t)||+r==r&&n[r].match(t);if(D)break}if(!D)return;D=D[0],D.slice(0,1)==="-"?(P=D,D={"-webkit-":"webkit","-moz-":"Moz","-ms-":"ms","-o-":"O"}[D]):P="-"+D.toLowerCase()+"-"},B={begin:function(){return 0},end:function(){return 1},linear:function(e){return e},quadratic:function(e){return e*e},cubic:function(e){return e*e*e},swing:function(e){return-Math.cos(e*Math.PI)/2+.5},sqrt:function(e){return Math.sqrt(e)},bounce:function(e){var t;if(e<=.5083)t=3;else if(e<=.8489)t=9;else if(e<=.96208)t=27;else{if(!(e<=.99981))return 1;t=91}return 1-Math.abs(3*Math.cos(e*t*1.028)/t)}};j.prototype.refresh=function(e){var r,i,s=!1;e===n?(s=!0,nt=[],vt=0,e=t.getElementsByTagName("*")):e=[].concat(e),r=0,i=e.length;for(;r<i;r++){var o=e[r],l=o,c=[],h=ht;if(!o.attributes)continue;var p=0,d=o.attributes.length;for(;p<d;p++){var g=o.attributes[p];if(g.name==="data-anchor-target"){l=t.querySelector(g.value);if(l===null)throw'Unable to find anchor target "'+g.value+'"';continue}if(g.name==="data-smooth-scrolling"){h=g.value!=="off";continue}var y=g.name.match(T);if(y===null)continue;var b=y[1];b=b&&ut[b.substr(1)]||0;var S=(y[2]|0)+b,x=y[3],N=y[4]||x,C={offset:S,props:g.value,element:o};c.push(C),!x||x===v||x===m?(C.mode="absolute",x===m?C.isEnd=!0:(C.frame=S*ot,delete C.offset)):(C.mode="relative",C.anchors=[x,N])}if(!c.length)continue;var k,L,A;!s&&E in o?(A=o[E],k=nt[A].styleAttr,L=nt[A].classAttr):(A=o[E]=vt++,k=o.style.cssText,L=K(o));var O=nt[A]={element:o,styleAttr:k,classAttr:L,anchorTarget:l,keyFrames:c,smoothScrolling:h};Q(o,[f,u],[a]),O[w]=!0}$(),r=0,i=e.length;for(;r<i;r++){var M=nt[e[r][E]];if(M===n)continue;M.keyFrames.sort(et),R(M),z(M)}return tt},j.prototype.relativeToAbsolute=function(e,t,n){var r=s.clientHeight,i=e.getBoundingClientRect(),o=i.top,u=i.bottom-i.top;return t===b?o-=r:t===y&&(o-=r/2),n===b?o+=u:n===y&&(o+=u/2),o+=tt.getScrollTop(),o+.5|0},j.prototype.animateTo=function(e,t){t=t||{};var r=Z(),i=tt.getScrollTop();return ct={startTop:i,topDiff:e-i,targetTop:e,duration:t.duration||p,startTime:r,endTime:r+(t.duration||p),easing:B[t.easing||h],done:t.done},ct.topDiff||(ct.done&&ct.done.call(tt,!1),ct=n),tt},j.prototype.stopAnimateTo=function(){ct&&ct.done&&ct.done.call(tt,!0),ct=n},j.prototype.isAnimatingTo=function(){return!!ct},j.prototype.setScrollTop=function(t,n){return n===!0&&(ft=t,dt=!0),r.iscroll?r.iscroll.scrollTo(0,-t):e.scrollTo(0,t),tt},j.prototype.getScrollTop=function(){return r.iscroll?-r.iscroll.y:e.pageYOffset||s.scrollTop||o.scrollTop||0},j.prototype.on=function(e,t){return rt[e]=t,tt},j.prototype.off=function(e){return delete rt[e],tt};var F=function(){var e,t,n,r,i,s,o,u,a,f,l;u=0,a=nt.length;for(;u<a;u++){e=nt[u],t=e.element,n=e.anchorTarget,r=e.keyFrames,i=0,s=r.length;for(;i<s;i++)o=r[i],o.mode==="relative"&&(f=t.style.cssText,l=K(t),t.style.cssText=e.styleAttr,Q(t,e.classAttr),o.frame=tt.relativeToAbsolute(n,o.anchors[0],o.anchors[1])-o.offset,t.style.cssText=f,Q(t,l)),it&&!o.isEnd&&o.frame>st&&(st=o.frame)}st=Math.max(st,J()),u=0,a=nt.length;for(;u<a;u++){e=nt[u],r=e.keyFrames,i=0,s=r.length;for(;i<s;i++)o=r[i],o.isEnd&&(o.frame=st-o.offset)}},I=function(e,t){var n=0,s=nt.length;for(;n<s;n++){var o=nt[n],f=o.smoothScrolling?e:t,l=o.keyFrames,c=l[0].frame,h=l[l.length-1].frame,p=f<=c,d=f>=h,v,m;if(p||d){var g=l[p?0:l.length-1].props;for(v in g)i.call(g,v)&&(m=V(g[v].value),r.setStyle(o.element,v,m));o[w]&&(f<c||f>h)&&(Q(o.element,[a],[u]),o[w]=!1);continue}o[w]||(Q(o.element,[u],[a]),o[w]=!0);var y=0,b=l.length-1;for(;y<b;y++)if(f>=l[y].frame&&f<=l[y+1].frame){var E=l[y],S=l[y+1];for(v in E.props)if(i.call(E.props,v)){var x=(f-E.frame)/(S.frame-E.frame);x=E.props[v].easing(x),m=X(E.props[v].value,S.props[v].value,x),m=V(m),r.setStyle(o.element,v,m)}break}}},q=function(){var e=tt.getScrollTop(),t,r=Z(),i;if(ct)r>=ct.endTime?(e=ct.targetTop,t=ct.done,ct=n):(i=ct.easing((r-ct.startTime)/ct.duration),e=ct.startTop+i*ct.topDiff|0),tt.setScrollTop(e);else{var s=pt.targetTop-e;s&&(pt={startTop:ft,topDiff:e-ft,targetTop:e,startTime:lt,endTime:lt+d}),r<=pt.endTime&&(i=B.sqrt((r-pt.startTime)/d),e=pt.startTop+i*pt.topDiff|0)}e<0&&(e=0);if(dt||ft!==e){at=e>=ft?"down":"up",dt=!1;var o={curTop:e,lastTop:ft,maxTop:st,direction:at},u=rt.beforerender&&rt.beforerender.call(tt,o);u!==!1&&(I(e,tt.getScrollTop()),ft=e,rt.render&&rt.render.call(tt,o)),t&&t.call(tt,!1)}lt=r},R=function(e){var t=0,n=e.keyFrames.length;for(;t<n;t++){var r=e.keyFrames[t],i,s,o,u={},a;while((a=N.exec(r.props))!==null)o=a[1],s=a[2],i=o.match(C),i!==null?(o=i[1],i=i[2]):i=h,s=s.indexOf("!")?U(s):[s.slice(1)],u[o]={value:s,easing:B[i]};r.props=u}},U=function(e){var t=[];return M.lastIndex=0,e=e.replace(M,function(e){return e.replace(A,function(e){return e/255*100+"%"})}),P&&(_.lastIndex=0,e=e.replace(_,function(e){return P+e})),e=e.replace(A,function(e){return t.push(+e),"{?}"}),t.unshift(e),t},z=function(e){var t={},n,r;n=0,r=e.keyFrames.length;for(;n<r;n++)W(e.keyFrames[n],t);t={},n=e.keyFrames.length-1;for(;n>=0;n--)W(e.keyFrames[n],t)},W=function(e,t){var n;for(n in t)i.call(e.props,n)||(e.props[n]=t[n]);for(n in e.props)t[n]=e.props[n]},X=function(e,t,n){var r,i=e.length;if(i!==t.length)throw"Can't interpolate between \""+e[0]+'" and "'+t[0]+'"';var s=[e[0]];r=1;for(;r<i;r++)s[r]=e[r]+(t[r]-e[r])*n;return s},V=function(e){var t=1;return O.lastIndex=0,e[0].replace(O,function(){return e[t++]})};r.setStyle=function(e,t,n){var r=e.style;t=t.replace(k,L).replace("-","");if(t==="zIndex")r[t]=""+(n|0);else if(t==="float")r.styleFloat=r.cssFloat=n;else try{D&&(r[D+t.slice(0,1).toUpperCase()+t.slice(1)]=n),r[t]=n}catch(i){}},r.addEvent=function(t,n,r){var i=function(t){return t=t||e.event,t.target||(t.target=t.srcElement),t.preventDefault||(t.preventDefault=function(){t.returnValue=!1}),r.call(this,t)};e.addEventListener?t.addEventListener(n,i,!1):t.attachEvent("on"+n,i)};var $=function(){st=0,F(),dt=!0,r.iscroll&&e.setTimeout(function(){r.iscroll.refresh()},0)},J=function(){var e=Math.max(o.scrollHeight,o.offsetHeight,s.scrollHeight,s.offsetHeight,s.clientHeight);return e-s.clientHeight},K=function(t){var n="className";return e.SVGElement&&t instanceof e.SVGElement&&(t=t[n],n="baseVal"),t[n]},Q=function(t,r,i){var s="className";e.SVGElement&&t instanceof e.SVGElement&&(t=t[s],s="baseVal");if(i===n){t[s]=r;return}var o=t[s],u=0,a=r.length;for(;u<a;u++)Y(o).indexOf(Y(r[u]))===-1&&(o+=" "+r[u]);var f=0,l=i.length;for(;f<l;f++)o=Y(o).replace(Y(i[f])," ");t[s]=G(o)},G=function(e){return e.replace(x,"")},Y=function(e){return" "+e+" "},Z=Date.now||function(){return+(new Date)},et=function(e,t){return e.frame-t.frame},tt,nt,rt,it,st=0,ot=1,ut,at="down",ft=-1,lt=Z(),ct,ht,pt,dt,vt=0})(window,document)});